操作系统-文件管理：

			文件的逻辑结构：

					1.逻辑结构的文件类型：  
									1.有结构文件：
										文件内容由 “定长记录” 和 “可变长记录” 组成
										定长记录存储 “文件格式”、“文件描述” 等结构化数据项
										可变长记录存储 “文件具体内容”
											有：
												a.文本文件
												b.文档（word、PPt...）
												c.多媒体文件（图片、视频...）

										如一个PNG格式的文件的逻辑结构：
											第一行：PNG文件标记
											第二行：PNG数据块
											第三行：文件结束标记
										定长记录：PNG文件标记、文件结束标记
										可变长记录：PNG数据块


									2.无结构文件：
										也称为流式文件
										文件内容长度以字节为单位
												a.二进制文件
												b.链接库（动态、静态）

												如：exe文件、dll文件、so文件


					2.顺序文件：
							指按顺序存放在存储介质中的文件
							磁带的存储特性使得磁带文件只能存储顺序文件
							顺序文件是所有逻辑文件当中存储效率最高的
							（因为在读和写只要按顺序读和写就可以了）

							那么在顺序文件中增、删、改要怎么办？
								在一个文件的中间添加内容，不可能把后面的内容都后移一个位置，把中间
								的空间让出来，再把新增的内容写进去
								————这样就会导致文件数据的增、删、改效率低
									（可变长文件不适合使用顺序文件格式存储）
									————因此出现了 “索引文件格式”


					3.索引文件：
							是为了解决可变长文件存储而发明的一种文件格式
							需要配合 “索引表” 来完成存储的操作

							假设我们要使用索引文件来存储一段内容：
							首先要建立一张 “索引表”，如:

							键   				逻辑地址(指向存储空间)
							2019-01-01			1
							2019-01-02			2
							2019-01-03			3







			辅存的存储空间分配：

					1.辅存的分配方式：
								1.连续分配：
										一个文件存储的时候需要一系列的扇区，分配的时候就把扇区连
										续的分配给它，如需要6个扇区，就把1~6的扇区分配给它

										优点：顺序读取文件非常容易，速度快
										缺点：对存储要求高，存储空间不仅要满足容量，而且要连续的
											 ————为了解决这个缺点，出现了 “链接分配”


								2.链接分配：
										可以将文件存储在离散的盘块中
										需要额外的存储空间存储文件的盘块链接顺序

										按额外存储空间的不同，分为：

										1.隐式链接：
											假设一个文件存储需要的盘块依次为：
												第2个、第9个、第7个、第18个、第16个
											则隐式分配会把指向下一个盘块的指针存储在当前盘块

											优点：非常适合顺序访问，我们只需要知道第一个盘块，就
												 可以顺序地查找其余的盘块
											缺点：
												1.随机访问效率很低，如：我们需要访问第18个盘
												  块，我们就得从头开始从第2个盘块开始访问，顺序
												  访问直到第18个
													（无论访问第几个，都得从第一个开始）

												2.可靠性差，任何一个链接出问题都会影响整个文件


										2.显式链接：
											假设一个文件存储需要的盘块依次为：
												第2个、第9个、第7个、第18个、第16个
											则显示分配会先创建一个 “FAT” 表
											“FAT” 表里会存储物理盘块和对应的下一盘块

											“FAT文件系统”：
													物理块    下一盘块
													  0         -
													  1         -
													  2         9
													  9         7
													 ...       ...

											缺点：
												1.不支持高效地直接存储（因为FAT记录项多）
												  磁盘越大，FAT记录项越多，若我们要存储一个比较
												  大的文件，我们需要检索FAT表，需要找到很多的空
												  闲的盘块

												2.检索时，FAT表占用较大的存储空间
												  （读取时，需要将整个FAT表加载到内存）

											————所以才有了 “索引分配”


								3.索引分配：
										把文件的所有盘块都集中存储（索引）
										每个文件都拥有一个 “索引块”，记录所有盘块信息
										当要读取某个文件时，只需要把这个文件的索引加载到内存便可

										例：
										假设一个文件存储需要的盘块依次为：
												第2个、第9个、第7个、第18个、第16个
										索引分配会使用一个额外的盘块去存储这个文件的所有盘块，这
										里假设使用第12个盘块存储
										即：
											1.第12个盘块是这个文件的索引
											2.第12个盘块会依次指向第2个、第9个、第7个、第18个、第16个盘块
											12:（2、9、7、18、16）

										优点：
											1.支持直接访问盘块
											2.文件较大时，索引分配具有明显优势



					2.辅存的存储空间管理：

						三个方法：

							1.空闲表（与主存的空间管理中的空闲表类似）：

								第一个空闲盘块号：这个磁盘里面第一个空闲的盘块号
								空闲盘块数：对应的这个盘块号下的这段空间空闲的盘块的数量

								序号   第一个空闲盘块号   空闲盘块数
								 1          2               4
								 2          9               1
								 3          11              32
								 4          56              20

								空闲盘区的分配与内存分配类似
								也使用首次适应算法、循环适应算法、快速适应算法
								回收过程也与内存回收类似


							2.空闲链表（与主存的空间管理中的空闲链表类似）：

								空闲链表法把所有盘区组成一个空闲链表
								每个链表节点存储空闲盘块和空闲的数目

								存储的数据和空闲表是一样的
								使用的方式和内存存储管理中的使用空闲链表的方式是一样的


							3.位示图：
								0表示空闲 1表示已使用

								盘块/磁道	1	2	3	4	5	6	7	8	9
									1		0	0	0	1	1	0	0	0	0
									2		0	1	0	1	0	1	0	0	0
									3		0	0	0	1	1	0	0	0	0
									4		0	0	1	0	0	0	0	0	0
									5		0	0	0	1	0	1	0	1	0
									6		0	0	0	1	1	0	0	0	0
									7		0	0	0	1	1	0	0	0	0

								优点：维护成本低
									 可以非常容易找到空闲盘块
									 位示图使用0/1比特位，占用空间小